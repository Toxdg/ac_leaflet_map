!function(a){function e(a,e){""==a&&(a=e);var o=a.split(",");return console.log(o),L.icon({iconUrl:o[0],iconSize:[o[1],o[2]],iconAnchor:[o[1]/2,o[2]],popupAnchor:[0,0]})}function o(a){var o=a.data("id"),t=(a.attr("id"),a.data("lat")),i=a.data("lng"),d=a.data("popup"),n=a.data("content"),l=a.data("url"),r=a.data("icon"),s=a.data("zoom"),c=a.data("style"),p=a.data("style_l"),u=L.map(o).setView([t,i],s);L.esri.basemapLayer(c).addTo(u),""!=p&&L.esri.basemapLayer(p).addTo(u),u.scrollWheelZoom.disable(),u.on("click",function(){u.scrollWheelZoom.enabled()?u.scrollWheelZoom.disable():u.scrollWheelZoom.enable()});var h=e(r,l);""!=n&&1==d?L.marker([t,i],{icon:h}).bindPopup(n).addTo(u):L.marker([t,i],{icon:h}).addTo(u)}function t(o){var t,i=o.data("id"),d=o.data("zoom"),n=[],l=o.data("mcluster"),r=o.data("url"),s=o.data("latfld"),c=o.data("lngfld"),p=o.data("popup"),u=o.data("style"),h=o.data("style_l"),f=0,m=0,y=0,b=o.find(".ac_poimaps_list_post_cat > li");b.each(function(){f+=a(this).data("lat"),m+=a(this).data("lng"),y+=1}),y>1&&(s=f/y,c=m/y);var v=L.map(i).setView([s,c],d);L.esri.basemapLayer(u).addTo(v),""!=h&&L.esri.basemapLayer(h).addTo(v),v.scrollWheelZoom.disable(),v.on("click",function(){v.scrollWheelZoom.enabled()?v.scrollWheelZoom.disable():v.scrollWheelZoom.enable()});var g=L.markerClusterGroup();b.each(function(o){var i=a(this).data("lat"),d=a(this).data("lng"),l=a(this).data("content"),s=a(this).data("icon"),c=e(s,r);""!=i&&""!=d?(t=""!=l&&1==p?L.marker([i,d],{wi_index:o,icon:c,alt:{index:o,opis:l}}).bindPopup(l):L.marker([i,d],{wi_index:o,alt:{index:o,opis:l},icon:c}),n.push(t),g.addLayer(t)):console.log("error point")}),1==l?v.addLayer(g):L.featureGroup(n).addTo(v)}function i(o){function t(){a.each(y,function(a,e){b.removeLayer(e)}),y=[],v.clearLayers()}function i(i,n){console.log("wybrane kryteria: id "+i+" woj "+n),t(),y=[],void 0===n?(s=o.data("latfld"),c=o.data("lngfld"),n="0"):(s=_.find(" > option:selected").data("lnt"),c=_.find(" > option:selected").data("lng"));var l=0,u=0,h=0,g=[];f.each(function(o){var t=a(this),s=a(this).data("lat"),c=a(this).data("lng"),f=a(this).data("icon"),m=a(this).data("content"),b=e(f,r),_=a(this).data("catid"),k=a(this).data("country"),w=k.split(","),x=_.split(",");-1!=a.inArray(n,w)&&-1!=a.inArray(i,x)?(g.push(t),u+=s,h+=c,l++,""!=s&&""!=c&&(d=""!=m&&1==p?L.marker([s,c],{wi_index:o,icon:b,alt:{index:o,opis:m}}).bindPopup(m):L.marker([s,c],{wi_index:o,icon:b,alt:{index:o,opis:m}}),y.push(d),v.addLayer(d))):console.log("punk nie spełnia warunków")}),1==m?b.addLayer(v):L.featureGroup(y).addTo(b)}var d,n=o.data("id"),l=o.data("zoom"),r=o.data("url"),s=o.data("latfld"),c=o.data("lngfld"),p=o.data("popup"),u=o.data("style"),h=o.data("style_l"),f=o.find(".ac_poimaps_full_list_post > li"),m=o.data("mcluster"),y=[],b=L.map(n).setView([s,c],l);L.esri.basemapLayer(u).addTo(b),""!=h&&L.esri.basemapLayer(h).addTo(b),b.scrollWheelZoom.disable(),b.on("click",function(){b.scrollWheelZoom.enabled()?b.scrollWheelZoom.disable():b.scrollWheelZoom.enable()});var v=L.markerClusterGroup();f.each(function(o){var t=a(this).data("lat"),i=a(this).data("lng"),n=a(this).data("content"),l=a(this).data("icon"),s=e(l,r);""!=t&&""!=i?(d=""!=n&&1==p?L.marker([t,i],{wi_index:o,icon:s,alt:{index:o,opis:n}}).bindPopup(n):L.marker([t,i],{wi_index:o,icon:s,alt:{index:o,opis:n}}),y.push(d),v.addLayer(d)):console.log("error point")}),1==m?b.addLayer(v):L.featureGroup(y).addTo(b);var g=o.find(".cat_select"),_=o.find(".woj_select");!function(){g.prop("selectedIndex",0),_.prop("selectedIndex",0)}(),_.change(function(){i(g.find("option:selected").val(),_.find(" > option:selected").val())}),g.change(function(){i(g.find("option:selected").val(),_.find(" > option:selected").val())})}a(document).ready(function(){console.log("Map start");var e=a(".ac_leaflet_map");if(!e.length)return void console.log("Map not found");e.each(function(e){var d=a(this).data("map");"single"==d?o(a(this)):"category"==d?t(a(this)):i(a(this))})})}(jQuery);