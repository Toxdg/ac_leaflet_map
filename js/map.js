!function(a){function e(a){var e=a.data("id"),t=(a.attr("id"),a.data("lat")),o=a.data("lng"),d=a.data("popup"),l=a.data("content"),i=(a.data("url"),a.data("icon"),a.data("zoom")),n=a.data("style"),r=a.data("style_l"),s=L.map(e).setView([t,o],i);L.esri.basemapLayer(n).addTo(s),""!=r&&L.esri.basemapLayer(r).addTo(s),s.scrollWheelZoom.disable(),s.on("click",function(){s.scrollWheelZoom.enabled()?s.scrollWheelZoom.disable():s.scrollWheelZoom.enable()}),""!=l&&1==d?L.marker([t,o]).bindPopup(l).addTo(s):L.marker([t,o]).addTo(s)}function t(e){var t,o=e.data("id"),d=e.data("zoom"),l=[],i=e.data("mcluster"),n=e.data("url"),r=e.data("latfld"),s=e.data("lngfld"),c=e.data("popup"),p=e.data("style"),u=e.data("style_l"),h=0,f=0,m=0,y=e.find(".ac_poimaps_list_post_cat > li");y.each(function(){h+=a(this).data("lat"),f+=a(this).data("lng"),m+=1}),m>1&&(r=h/m,s=f/m);var b=L.map(o).setView([r,s],d);L.esri.basemapLayer(p).addTo(b),""!=u&&L.esri.basemapLayer(u).addTo(b),b.scrollWheelZoom.disable(),b.on("click",function(){b.scrollWheelZoom.enabled()?b.scrollWheelZoom.disable():b.scrollWheelZoom.enable()});var v=L.markerClusterGroup();y.each(function(e){var o=a(this).data("lat"),d=a(this).data("lng"),i=a(this).data("content"),r=a(this).data("icon");"null"!=r&&(n=r),""!=o&&""!=d?(t=""!=i&&1==c?L.marker([o,d],{wi_index:e,alt:{index:e,opis:i}}).bindPopup(i):L.marker([o,d],{wi_index:e,alt:{index:e,opis:i}}),l.push(t),v.addLayer(t)):console.log("error point")}),1==i?b.addLayer(v):L.featureGroup(l).addTo(b)}function o(e){function t(){a.each(m,function(a,e){y.removeLayer(e)}),m=[],b.clearLayers()}function o(o,l){console.log("wybrane kryteria: id "+o+" woj "+l),t(),m=[],void 0===l?(r=e.data("latfld"),s=e.data("lngfld"),l="0"):(r=_.find(" > option:selected").data("lnt"),s=_.find(" > option:selected").data("lng"));var i=0,p=0,u=0,v=[];h.each(function(e){var t=a(this),r=a(this).data("lat"),s=a(this).data("lng"),h=a(this).data("icon"),f=a(this).data("content");"null"!=h&&(n=h);var y=a(this).data("catid"),_=a(this).data("country"),g=_.split(","),k=y.split(",");-1!=a.inArray(l,g)&&-1!=a.inArray(o,k)?(v.push(t),p+=r,u+=s,i++,""!=r&&""!=s&&(d=""!=f&&1==c?L.marker([r,s],{wi_index:e,alt:{index:e,opis:f}}).bindPopup(f):L.marker([r,s],{wi_index:e,alt:{index:e,opis:f}}),m.push(d),b.addLayer(d))):console.log("punk nie spełnia warunków")}),1==f?y.addLayer(b):L.featureGroup(m).addTo(y)}var d,l=e.data("id"),i=e.data("zoom"),n=e.data("url"),r=e.data("latfld"),s=e.data("lngfld"),c=e.data("popup"),p=e.data("style"),u=e.data("style_l"),h=e.find(".ac_poimaps_full_list_post > li"),f=e.data("mcluster"),m=[],y=L.map(l).setView([r,s],i);L.esri.basemapLayer(p).addTo(y),""!=u&&L.esri.basemapLayer(u).addTo(y),y.scrollWheelZoom.disable(),y.on("click",function(){y.scrollWheelZoom.enabled()?y.scrollWheelZoom.disable():y.scrollWheelZoom.enable()});var b=L.markerClusterGroup();h.each(function(e){var t=a(this).data("lat"),o=a(this).data("lng"),l=a(this).data("content"),i=a(this).data("icon");"null"!=i&&(n=i),""!=t&&""!=o?(d=""!=l&&1==c?L.marker([t,o],{wi_index:e,alt:{index:e,opis:l}}).bindPopup(l):L.marker([t,o],{wi_index:e,alt:{index:e,opis:l}}),m.push(d),b.addLayer(d)):console.log("error point")}),1==f?y.addLayer(b):L.featureGroup(m).addTo(y);var v=e.find(".cat_select"),_=e.find(".woj_select");!function(){v.prop("selectedIndex",0),_.prop("selectedIndex",0)}(),_.change(function(){o(v.find("option:selected").val(),_.find(" > option:selected").val())}),v.change(function(){o(v.find("option:selected").val(),_.find(" > option:selected").val())})}a(document).ready(function(){console.log("Map start");var d=a(".ac_leaflet_map");if(!d.length)return void console.log("Map not found");d.each(function(d){var l=a(this).data("map");"single"==l?e(a(this)):"category"==l?t(a(this)):o(a(this))})})}(jQuery);