!function(a){function e(a){var e=a.data("id"),t=(a.attr("id"),a.data("lat")),o=a.data("lng"),l=a.data("popup"),d=a.data("content"),i=(a.data("url"),a.data("icon"),a.data("zoom")),n=a.data("style"),s=a.data("style_l"),r=L.map(e).setView([t,o],i);L.esri.basemapLayer(n).addTo(r),""!=s&&L.esri.basemapLayer(s).addTo(r),r.scrollWheelZoom.disable(),r.on("click",function(){r.scrollWheelZoom.enabled()?r.scrollWheelZoom.disable():r.scrollWheelZoom.enable()}),""!=d&&1==l?L.marker([t,o]).bindPopup(d).addTo(r):L.marker([t,o]).addTo(r)}function t(e){var t,o=e.data("id"),l=e.data("zoom"),d=[],i=e.data("mcluster"),n=e.data("url"),s=e.data("latfld"),r=e.data("lngfld"),c=e.data("popup"),p=e.data("style"),u=e.data("style_l"),h=0,f=0,m=0,b=e.find(".ac_poimaps_list_post_cat > li");b.each(function(){h+=a(this).data("lat"),f+=a(this).data("lng"),m+=1}),m>1&&(s=h/m,r=f/m);var y=L.map(o).setView([s,r],l);L.esri.basemapLayer(p).addTo(y),""!=u&&L.esri.basemapLayer(u).addTo(y),y.scrollWheelZoom.disable(),y.on("click",function(){y.scrollWheelZoom.enabled()?y.scrollWheelZoom.disable():y.scrollWheelZoom.enable()});var _=L.markerClusterGroup();b.each(function(e){var o=a(this).data("lat"),l=a(this).data("lng"),i=a(this).data("content"),s=a(this).data("icon");"null"!=s&&(n=s),""!=o&&""!=l?(t=""!=i&&1==c?L.marker([o,l],{wi_index:e,alt:{index:e,opis:i}}).bindPopup(i):L.marker([o,l],{wi_index:e,alt:{index:e,opis:i}}),d.push(t),_.addLayer(t)):console.log("error point")}),1==i?y.addLayer(_):L.featureGroup(d).addTo(y)}function o(e){function t(){a.each(f,function(a,e){m.removeLayer(e)}),f=[]}function o(o,d){console.log("wybrane kryteria: id "+o+" woj "+d),t(),f=[],void 0===d?(s=e.data("latfld"),r=e.data("lngfld"),d="0"):(s=y.find(" > option:selected").data("lnt"),r=y.find(" > option:selected").data("lng"));var i=0,p=0,u=0,b=[];h.each(function(e){var t=a(this),s=a(this).data("lat"),r=a(this).data("lng"),h=a(this).data("icon"),m=a(this).data("content");"null"!=h&&(n=h);var y=a(this).data("catid"),_=a(this).data("country"),g=_.split(","),v=y.split(",");-1!=a.inArray(d,g)&&-1!=a.inArray(o,v)?(b.push(t),p+=s,u+=r,i++,""!=s&&""!=r&&(l=""!=m&&1==c?L.marker([s,r],{wi_index:e,alt:{index:e,opis:m}}).bindPopup(m):L.marker([s,r],{wi_index:e,alt:{index:e,opis:m}}),f.push(l))):console.log("punk nie spełnia warunków")}),L.featureGroup(f).addTo(m)}var l,d=e.data("id"),i=e.data("zoom"),n=e.data("url"),s=e.data("latfld"),r=e.data("lngfld"),c=e.data("popup"),p=e.data("style"),u=e.data("style_l"),h=e.find(".ac_poimaps_full_list_post > li"),f=[],m=L.map(d).setView([s,r],i);L.esri.basemapLayer(p).addTo(m),""!=u&&L.esri.basemapLayer(u).addTo(m),m.scrollWheelZoom.disable(),m.on("click",function(){m.scrollWheelZoom.enabled()?m.scrollWheelZoom.disable():m.scrollWheelZoom.enable()}),h.each(function(e){var t=a(this).data("lat"),o=a(this).data("lng"),d=a(this).data("content"),i=a(this).data("icon");"null"!=i&&(n=i),""!=t&&""!=o?(l=""!=d&&1==c?L.marker([t,o],{wi_index:e,alt:{index:e,opis:d}}).bindPopup(d):L.marker([t,o],{wi_index:e,alt:{index:e,opis:d}}),f.push(l)):console.log("error point"),L.featureGroup(f).addTo(m)});var b=e.find(".cat_select"),y=e.find(".woj_select");!function(){b.prop("selectedIndex",0),y.prop("selectedIndex",0)}(),y.change(function(){o(b.find("option:selected").val(),y.find(" > option:selected").val())}),b.change(function(){o(b.find("option:selected").val(),y.find(" > option:selected").val())})}a(document).ready(function(){console.log("Map start");var l=a(".ac_leaflet_map");if(!l.length)return void console.log("Map not found");l.each(function(l){var d=a(this).data("map");"single"==d?e(a(this)):"category"==d?t(a(this)):o(a(this))})})}(jQuery);