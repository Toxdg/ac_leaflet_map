!function(a){function o(a){var o=a.data("id"),e=(a.attr("id"),a.data("lat")),t=a.data("lng"),i=a.data("popup"),n=a.data("content"),l=(a.data("url"),a.data("icon"),a.data("zoom")),d=L.map(o).setView([e,t],l);L.esri.basemapLayer("Topographic").addTo(d),d.scrollWheelZoom.disable(),d.on("click",function(){d.scrollWheelZoom.enabled()?d.scrollWheelZoom.disable():d.scrollWheelZoom.enable()}),""!=n&&1==i?L.marker([e,t]).bindPopup(n).addTo(d):L.marker([e,t]).addTo(d)}function e(o){var e,t=o.data("id"),i=o.data("zoom"),n=[],l=o.data("url"),d=o.data("latfld"),s=o.data("lngfld"),r=o.data("popup"),c=0,p=0,u=0,h=o.find(".ac_poimaps_list_post_cat > li");h.each(function(){c+=a(this).data("lat"),p+=a(this).data("lng"),u+=1}),u>1&&(d=c/u,s=p/u);var f=L.map(t).setView([d,s],i);L.esri.basemapLayer("Topographic").addTo(f),f.scrollWheelZoom.disable(),f.on("click",function(){f.scrollWheelZoom.enabled()?f.scrollWheelZoom.disable():f.scrollWheelZoom.enable()}),h.each(function(o){var t=a(this).data("lat"),i=a(this).data("lng"),d=a(this).data("content"),s=a(this).data("icon");"null"!=s&&(l=s),""!=t&&""!=i?(e=""!=d&&1==r?L.marker([t,i],{wi_index:o,alt:{index:o,opis:d}}).bindPopup(d):L.marker([t,i],{wi_index:o,alt:{index:o,opis:d}}),n.push(e)):console.log("error point"),L.featureGroup(n).addTo(f)})}function t(o){function e(){a.each(u,function(a,o){h.removeLayer(o)}),u=[]}function t(t,n){console.log("wybrane kryteria: id "+t+" woj "+n),e(),u=[],void 0===n?(s=o.data("latfld"),r=o.data("lngfld"),n="0"):(s=m.find(" > option:selected").data("lnt"),r=m.find(" > option:selected").data("lng"));var l=0,f=0,g=0,b=[];p.each(function(o){var e=a(this),s=a(this).data("lat"),r=a(this).data("lng"),p=a(this).data("icon"),h=a(this).data("content");"null"!=p&&(d=p);var m=a(this).data("catid"),v=a(this).data("country"),_=v.split(","),k=m.split(",");-1!=a.inArray(n,_)&&-1!=a.inArray(t,k)?(b.push(e),f+=s,g+=r,l++,""!=s&&""!=r&&(i=""!=h&&1==c?L.marker([s,r],{wi_index:o,alt:{index:o,opis:h}}).bindPopup(h):L.marker([s,r],{wi_index:o,alt:{index:o,opis:h}}),u.push(i))):console.log("punk nie spełnia warunków")}),L.featureGroup(u).addTo(h)}var i,n=o.data("id"),l=o.data("zoom"),d=o.data("url"),s=o.data("latfld"),r=o.data("lngfld"),c=o.data("popup"),p=o.find(".ac_poimaps_full_list_post > li"),u=[],h=L.map(n).setView([s,r],l);L.esri.basemapLayer("Topographic").addTo(h),h.scrollWheelZoom.disable(),h.on("click",function(){h.scrollWheelZoom.enabled()?h.scrollWheelZoom.disable():h.scrollWheelZoom.enable()}),p.each(function(o){var e=a(this).data("lat"),t=a(this).data("lng"),n=a(this).data("content"),l=a(this).data("icon");"null"!=l&&(d=l),""!=e&&""!=t?(i=""!=n&&1==c?L.marker([e,t],{wi_index:o,alt:{index:o,opis:n}}).bindPopup(n):L.marker([e,t],{wi_index:o,alt:{index:o,opis:n}}),u.push(i)):console.log("error point"),L.featureGroup(u).addTo(h)});var f=o.find(".cat_select"),m=o.find(".woj_select");!function(){f.prop("selectedIndex",0),m.prop("selectedIndex",0)}(),m.change(function(){t(f.find("option:selected").val(),m.find(" > option:selected").val())}),f.change(function(){t(f.find("option:selected").val(),m.find(" > option:selected").val())})}a(document).ready(function(){console.log("Map start");var i=a(".ac_leaflet_map");if(!i.length)return void console.log("Map not found");i.each(function(i){var n=a(this).data("map");"single"==n?o(a(this)):"category"==n?e(a(this)):t(a(this))})})}(jQuery);